# Assignment 3 - Task 2 (CUDA): Vector Add and Block Size Impact

В данном задании реализована программа на **CUDA C++** для поэлементного сложения
двух массивов (`C[i] = A[i] + B[i]`) и исследовано влияние **размера блока потоков**
на производительность вычислений на GPU.

Эксперимент проведён для массива размером **N = 1 000 000** элементов с измерением
времени выполнения вычислительного ядра для нескольких значений размера блока.

## Цель работы
- Реализовать CUDA-программу для поэлементного сложения массивов.
- Исследовать влияние размера блока потоков на время выполнения ядра.
- Провести замеры времени для как минимум трёх различных размеров блока.
- Определить оптимальный размер блока для данной задачи.

## Описание реализации

Программа выполняет следующие шаги:
1. Генерирует два массива `A` и `B` размера `N` и заполняет их случайными числами.
2. Копирует входные данные в память GPU.
3. Запускает CUDA-ядро `vec_add`, выполняющее поэлементное сложение: C[i] = A[i] + B[i]
4. Измеряет время выполнения ядра с помощью `cudaEvent`.
5. Повторяет измерения для разных размеров блока потоков.
6. Проверяет корректность результата сравнением с CPU-эталоном.

## Параметры эксперимента
- Размер массива: `N = 1 000 000`
- Количество запусков для усреднения: `300`
- Протестированные размеры блока:
- 128 потоков
- 256 потоков
- 512 потоков
- 1024 потока
- Размер сетки (`grid`) рассчитывается как: grid = ceil(N / block)

## Результаты измерений
Результаты эксперимента представлены ниже:

| Block size | Grid size | Avg kernel time (ms) |
|-----------:|----------:|---------------------:|
| 128        | 7813      | 0.049300             |
| 256        | 3907      | 0.049268             |
| 512        | 1954      | 0.049412             |
| 1024       | 977       | 0.051036             |

**Лучший результат** был получен при размере блока **256 потоков**.

## Проверка корректности

Корректность вычислений проверялась путём сравнения результата CUDA-версии с
эталонным CPU-результатом.
Max abs error = 0.000000
Correct = YES

Это подтверждает корректную работу программы для всех протестированных
размеров блока.

## Анализ и выводы
Полученные результаты показывают, что для задачи поэлементного сложения массивов
влияние размера блока потоков на производительность выражено слабо. Это объясняется
линейным и согласованным доступом к глобальной памяти.

Тем не менее, размер блока **256 потоков** показал наименьшее время выполнения,
что делает его оптимальным выбором для данной задачи. Использование слишком больших
блоков (1024 потока) приводит к небольшому снижению производительности из-за
ограничений ресурсов GPU и снижения occupancy.

## Сборка и запуск (Google Colab)
Пример компиляции для GPU Tesla T4:

```bash
!nvcc -O3 -std=c++17 -arch=sm_75 ass3_task2.cu -o ass3_task2
