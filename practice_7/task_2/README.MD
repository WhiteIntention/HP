# Задание 7.2 — Реализация префиксной суммы на CUDA

## Описание работы  
В данной работе реализована **префиксная сумма (prefix sum, inclusive scan)** для одномерного массива с использованием CUDA.  
Вычисления выполняются на GPU с применением **разделяемой памяти (shared memory)**, что позволяет ускорить доступ к данным внутри блока.

Для проверки корректности результат GPU сравнивается с эталонной реализацией на CPU.

---

## Постановка задачи  
1. Написать CUDA-ядро для вычисления префиксной суммы элементов массива.  
2. Использовать shared memory для оптимизации вычислений.  
3. Проверить корректность работы алгоритма на тестовых массивах.

---

## Идея реализации  
- Префиксная сумма сначала считается **внутри каждого блока**.
- Для этого используется алгоритм **Blelloch exclusive scan** в shared memory.
- Затем exclusive scan переводится в **inclusive scan**.
- Параллельно для каждого блока вычисляется сумма его элементов.
- Суммы блоков рекурсивно сканируются на GPU.
- Полученные значения добавляются как оффсеты ко всем элементам соответствующих блоков.
- Корректность проверяется сравнением с CPU-версией.

---

## Тестовые данные  
Для тестирования использовались массивы случайных чисел следующих размеров:
- `1024` элементов  
- `1 000 000` элементов  
- `10 000 000` элементов  

---

## Результаты вычислений  

### N = 1024
- **Максимальная абсолютная ошибка:** 0.000031  
- **Время выполнения на GPU:** 0.203200 ms  

### N = 1 000 000
- **Максимальная абсолютная ошибка:** 0.062500  
- **Время выполнения на GPU:** 0.564384 ms  

### N = 10 000 000
- **Максимальная абсолютная ошибка:** 1.000000  
- **Время выполнения на GPU:** 3.727264 ms  

---

## Анализ результатов  
- Абсолютная погрешность увеличивается при росте размера массива.  
  Это связано с:
  - использованием типа `float` на GPU;
  - накоплением ошибок округления при большом количестве операций сложения;
  - различным порядком суммирования элементов на CPU и GPU.
- Несмотря на рост абсолютной ошибки, алгоритм корректно воспроизводит форму префиксной суммы.
- Время выполнения растёт линейно с увеличением размера массива, что соответствует ожидаемому поведению алгоритма.

---

## Сборка и запуск (Google Colab)
```bash
nvcc -O2 -std=c++17 -arch=sm_75 7_2.cu -o 7_2
./7_2
